<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mewayz - Dashboard</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/Icon-192.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #101010;
            color: #F1F1F1;
            min-height: 100vh;
        }

        .dashboard {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: #191919;
            border-right: 1px solid #333;
            padding: 20px;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 20px 0;
            border-bottom: 1px solid #333;
            margin-bottom: 20px;
        }

        .sidebar-header h1 {
            color: #FDFDFD;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .sidebar-header p {
            color: #7B7B7B;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 5px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: #7B7B7B;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-link:hover, .nav-link.active {
            background: #333;
            color: #FDFDFD;
        }

        .nav-link.active {
            background: #4ECDC4;
            color: #101010;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            font-size: 1.2rem;
        }

        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #333;
        }

        .header h1 {
            color: #FDFDFD;
            font-size: 2rem;
            font-weight: 700;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #4ECDC4;
            color: #101010;
        }

        .btn-primary:hover {
            background: #45B7D1;
        }

        .btn-secondary {
            background: #333;
            color: #FDFDFD;
        }

        .btn-secondary:hover {
            background: #444;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #191919;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #333;
        }

        .stat-card h3 {
            color: #7B7B7B;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .stat-value {
            color: #4ECDC4;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-change {
            color: #22c55e;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .stat-change.negative {
            color: #ef4444;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .feature-card {
            background: #191919;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #333;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            border-color: #4ECDC4;
            transform: translateY(-2px);
        }

        .feature-card h3 {
            color: #FDFDFD;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .feature-card p {
            color: #7B7B7B;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .feature-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #22c55e;
        }

        .status-dot.inactive {
            background: #7B7B7B;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: #333;
            border-radius: 8px;
            margin-top: 20px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #4ECDC4;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #101010;
            font-weight: 700;
        }

        .user-info h4 {
            color: #FDFDFD;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .user-info p {
            color: #7B7B7B;
            font-size: 0.8rem;
        }

        .logout-btn {
            background: #dc2626;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: auto;
        }

        .logout-btn:hover {
            background: #b91c1c;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #333;
            border-top: 3px solid #4ECDC4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            background: #dc2626;
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .success-message {
            background: #059669;
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .dashboard {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 1px solid #333;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>Mewayz</h1>
                <p>Business Platform</p>
            </div>
            
            <nav>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" data-section="overview">
                            <span class="nav-icon">üìä</span>
                            Overview
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="workspaces">
                            <span class="nav-icon">üè¢</span>
                            Workspaces
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="social-media">
                            <span class="nav-icon">üì±</span>
                            Social Media
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="bio-sites">
                            <span class="nav-icon">üîó</span>
                            Bio Sites
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="crm">
                            <span class="nav-icon">üë•</span>
                            CRM
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="email-marketing">
                            <span class="nav-icon">üìß</span>
                            Email Marketing
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="ecommerce">
                            <span class="nav-icon">üõí</span>
                            E-commerce
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="courses">
                            <span class="nav-icon">üìö</span>
                            Courses
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="analytics">
                            <span class="nav-icon">üìà</span>
                            Analytics
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="settings">
                            <span class="nav-icon">‚öôÔ∏è</span>
                            Settings
                        </a>
                    </li>
                </ul>
            </nav>
            
            <div class="user-profile">
                <div class="user-avatar" id="user-avatar">U</div>
                <div class="user-info">
                    <h4 id="user-name">Loading...</h4>
                    <p id="user-email">Loading...</p>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>
        
        <div class="main-content">
            <div id="error-message" class="error-message" style="display: none;"></div>
            <div id="success-message" class="success-message" style="display: none;"></div>
            
            <!-- Overview Section -->
            <div id="overview" class="content-section active">
                <div class="header">
                    <h1>Dashboard Overview</h1>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="refreshData()">Refresh</button>
                        <button class="btn btn-primary" onclick="showSection('workspaces')">Create Workspace</button>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total Workspaces</h3>
                        <div class="stat-value" id="total-workspaces">-</div>
                        <div class="stat-change" id="workspaces-change">Loading...</div>
                    </div>
                    <div class="stat-card">
                        <h3>Social Media Accounts</h3>
                        <div class="stat-value" id="social-accounts">-</div>
                        <div class="stat-change" id="social-change">Loading...</div>
                    </div>
                    <div class="stat-card">
                        <h3>Bio Sites</h3>
                        <div class="stat-value" id="bio-sites">-</div>
                        <div class="stat-change" id="bio-change">Loading...</div>
                    </div>
                    <div class="stat-card">
                        <h3>CRM Contacts</h3>
                        <div class="stat-value" id="crm-contacts">-</div>
                        <div class="stat-change" id="crm-change">Loading...</div>
                    </div>
                </div>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <h3>üì± Social Media Management</h3>
                        <p>Manage all your social media accounts from one place</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>Active</span>
                        </div>
                    </div>
                    <div class="feature-card">
                        <h3>üîó Bio Sites</h3>
                        <p>Create professional link-in-bio pages</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>Active</span>
                        </div>
                    </div>
                    <div class="feature-card">
                        <h3>üë• CRM System</h3>
                        <p>Manage leads and customer relationships</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>Active</span>
                        </div>
                    </div>
                    <div class="feature-card">
                        <h3>üìß Email Marketing</h3>
                        <p>Create and send professional email campaigns</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>Active</span>
                        </div>
                    </div>
                    <div class="feature-card">
                        <h3>üõí E-commerce</h3>
                        <p>Sell products online with integrated payment</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>Active</span>
                        </div>
                    </div>
                    <div class="feature-card">
                        <h3>üìö Course Management</h3>
                        <p>Create and sell online courses</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>Active</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Workspaces Section -->
            <div id="workspaces" class="content-section">
                <div class="header">
                    <h1>Workspaces</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="createWorkspace()">Create Workspace</button>
                    </div>
                </div>
                
                <div class="loading" id="workspaces-loading">
                    <div class="loading-spinner"></div>
                    <p>Loading workspaces...</p>
                </div>
                
                <div id="workspaces-content" style="display: none;">
                    <div class="feature-grid" id="workspaces-grid">
                        <!-- Workspaces will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Social Media Section -->
            <div id="social-media" class="content-section">
                <div class="header">
                    <h1>Social Media Management</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="connectSocialAccount()">Connect Account</button>
                    </div>
                </div>
                
                <div class="loading" id="social-loading">
                    <div class="loading-spinner"></div>
                    <p>Loading social media accounts...</p>
                </div>
                
                <div id="social-content" style="display: none;">
                    <div class="feature-grid" id="social-grid">
                        <!-- Social media accounts will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Bio Sites Section -->
            <div id="bio-sites" class="content-section">
                <div class="header">
                    <h1>Bio Sites</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="createBioSite()">Create Bio Site</button>
                    </div>
                </div>
                
                <div class="loading" id="bio-loading">
                    <div class="loading-spinner"></div>
                    <p>Loading bio sites...</p>
                </div>
                
                <div id="bio-content" style="display: none;">
                    <div class="feature-grid" id="bio-grid">
                        <!-- Bio sites will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- CRM Section -->
            <div id="crm" class="content-section">
                <div class="header">
                    <h1>CRM</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="createLead()">Create Lead</button>
                    </div>
                </div>
                
                <div class="loading" id="crm-loading">
                    <div class="loading-spinner"></div>
                    <p>Loading CRM data...</p>
                </div>
                
                <div id="crm-content" style="display: none;">
                    <div class="feature-grid" id="crm-grid">
                        <!-- CRM data will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Email Marketing Section -->
            <div id="email-marketing" class="content-section">
                <div class="header">
                    <h1>Email Marketing</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="createCampaign()">Create Campaign</button>
                    </div>
                </div>
                
                <div class="loading" id="email-loading">
                    <div class="loading-spinner"></div>
                    <p>Loading email campaigns...</p>
                </div>
                
                <div id="email-content" style="display: none;">
                    <div class="feature-grid" id="email-grid">
                        <!-- Email campaigns will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- E-commerce Section -->
            <div id="ecommerce" class="content-section">
                <div class="header">
                    <h1>E-commerce</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="createProduct()">Create Product</button>
                    </div>
                </div>
                
                <div class="loading" id="ecommerce-loading">
                    <div class="loading-spinner"></div>
                    <p>Loading products...</p>
                </div>
                
                <div id="ecommerce-content" style="display: none;">
                    <div class="feature-grid" id="ecommerce-grid">
                        <!-- Products will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Courses Section -->
            <div id="courses" class="content-section">
                <div class="header">
                    <h1>Course Management</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="createCourse()">Create Course</button>
                    </div>
                </div>
                
                <div class="loading" id="courses-loading">
                    <div class="loading-spinner"></div>
                    <p>Loading courses...</p>
                </div>
                
                <div id="courses-content" style="display: none;">
                    <div class="feature-grid" id="courses-grid">
                        <!-- Courses will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Analytics Section -->
            <div id="analytics" class="content-section">
                <div class="header">
                    <h1>Analytics</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="generateReport()">Generate Report</button>
                    </div>
                </div>
                
                <div class="loading" id="analytics-loading">
                    <div class="loading-spinner"></div>
                    <p>Loading analytics...</p>
                </div>
                
                <div id="analytics-content" style="display: none;">
                    <div class="feature-grid" id="analytics-grid">
                        <!-- Analytics will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Settings Section -->
            <div id="settings" class="content-section">
                <div class="header">
                    <h1>Settings</h1>
                </div>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <h3>üîê Two-Factor Authentication</h3>
                        <p>Secure your account with 2FA</p>
                        <div class="feature-status">
                            <span class="status-dot inactive" id="2fa-status"></span>
                            <span id="2fa-text">Checking...</span>
                        </div>
                        <button class="btn btn-primary" onclick="setup2FA()" style="margin-top: 10px;">Setup 2FA</button>
                    </div>
                    <div class="feature-card">
                        <h3>üîó OAuth Accounts</h3>
                        <p>Manage connected social accounts</p>
                        <div class="feature-status">
                            <span class="status-dot" id="oauth-status"></span>
                            <span id="oauth-text">Checking...</span>
                        </div>
                        <button class="btn btn-primary" onclick="manageOAuth()" style="margin-top: 10px;">Manage OAuth</button>
                    </div>
                    <div class="feature-card">
                        <h3>üë§ Profile Settings</h3>
                        <p>Update your profile information</p>
                        <button class="btn btn-primary" onclick="updateProfile()" style="margin-top: 10px;">Update Profile</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'https://d6c7fe62-7500-44b0-b627-88f7eaeeac56.preview.emergentagent.com/api';
        let authToken = localStorage.getItem('auth_token');
        let currentUser = null;

        // Check authentication
        if (!authToken) {
            window.location.href = '/login';
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', async () => {
            await loadUserData();
            await loadDashboardData();
            setupNavigation();
        });

        // Setup navigation
        function setupNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const section = link.getAttribute('data-section');
                    showSection(section);
                });
            });
        }

        // Show section
        function showSection(sectionName) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.remove('active'));

            // Show selected section
            document.getElementById(sectionName).classList.add('active');

            // Update navigation
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));
            document.querySelector(`[data-section="${sectionName}"]`).classList.add('active');

            // Load section data
            loadSectionData(sectionName);
        }

        // Load user data
        async function loadUserData() {
            try {
                const response = await fetch(`${API_BASE_URL}/auth/me`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    currentUser = data.user;
                    
                    // Update user profile
                    document.getElementById('user-name').textContent = currentUser.name;
                    document.getElementById('user-email').textContent = currentUser.email;
                    document.getElementById('user-avatar').textContent = currentUser.name.charAt(0).toUpperCase();
                } else {
                    throw new Error('Failed to load user data');
                }
            } catch (error) {
                console.error('Error loading user data:', error);
                logout();
            }
        }

        // Load dashboard data
        async function loadDashboardData() {
            try {
                // Load workspaces
                const workspacesResponse = await fetch(`${API_BASE_URL}/workspaces`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const workspacesData = await workspacesResponse.json();
                if (workspacesData.success) {
                    document.getElementById('total-workspaces').textContent = workspacesData.workspaces.length;
                    document.getElementById('workspaces-change').textContent = 'Active';
                }

                // Load social media accounts
                const socialResponse = await fetch(`${API_BASE_URL}/social-media/accounts`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const socialData = await socialResponse.json();
                if (socialData.success) {
                    document.getElementById('social-accounts').textContent = socialData.accounts.length;
                    document.getElementById('social-change').textContent = 'Connected';
                }

                // Load bio sites
                const bioResponse = await fetch(`${API_BASE_URL}/bio-sites`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const bioData = await bioResponse.json();
                if (bioData.success) {
                    document.getElementById('bio-sites').textContent = bioData.bio_sites.length;
                    document.getElementById('bio-change').textContent = 'Active';
                }

                // Load CRM contacts
                const crmResponse = await fetch(`${API_BASE_URL}/crm/contacts`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const crmData = await crmResponse.json();
                if (crmData.success) {
                    document.getElementById('crm-contacts').textContent = crmData.contacts.length;
                    document.getElementById('crm-change').textContent = 'Updated';
                }

                // Load 2FA status
                const tfaResponse = await fetch(`${API_BASE_URL}/auth/2fa/status`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const tfaData = await tfaResponse.json();
                if (tfaData.success) {
                    const statusDot = document.getElementById('2fa-status');
                    const statusText = document.getElementById('2fa-text');
                    if (tfaData.two_factor_enabled) {
                        statusDot.classList.remove('inactive');
                        statusText.textContent = 'Enabled';
                    } else {
                        statusDot.classList.add('inactive');
                        statusText.textContent = 'Disabled';
                    }
                }

                // Load OAuth status
                const oauthResponse = await fetch(`${API_BASE_URL}/auth/oauth/status`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                const oauthData = await oauthResponse.json();
                if (oauthData.success) {
                    const statusDot = document.getElementById('oauth-status');
                    const statusText = document.getElementById('oauth-text');
                    if (oauthData.oauth_status.linked) {
                        statusDot.classList.remove('inactive');
                        statusText.textContent = `Connected to ${oauthData.oauth_status.provider}`;
                    } else {
                        statusDot.classList.add('inactive');
                        statusText.textContent = 'Not connected';
                    }
                }

            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }

        // Load section data
        async function loadSectionData(sectionName) {
            const loadingElement = document.getElementById(`${sectionName}-loading`);
            const contentElement = document.getElementById(`${sectionName}-content`);
            
            if (loadingElement) loadingElement.style.display = 'block';
            if (contentElement) contentElement.style.display = 'none';

            try {
                switch (sectionName) {
                    case 'workspaces':
                        await loadWorkspaces();
                        break;
                    case 'social-media':
                        await loadSocialMedia();
                        break;
                    case 'bio-sites':
                        await loadBioSites();
                        break;
                    case 'crm':
                        await loadCRM();
                        break;
                    case 'email-marketing':
                        await loadEmailMarketing();
                        break;
                    case 'ecommerce':
                        await loadEcommerce();
                        break;
                    case 'courses':
                        await loadCourses();
                        break;
                    case 'analytics':
                        await loadAnalytics();
                        break;
                }
            } catch (error) {
                console.error(`Error loading ${sectionName} data:`, error);
            } finally {
                if (loadingElement) loadingElement.style.display = 'none';
                if (contentElement) contentElement.style.display = 'block';
            }
        }

        // Load workspaces
        async function loadWorkspaces() {
            const response = await fetch(`${API_BASE_URL}/workspaces`, {
                headers: { 'Authorization': `Bearer ${authToken}` }
            });
            const data = await response.json();
            
            if (data.success) {
                const grid = document.getElementById('workspaces-grid');
                grid.innerHTML = '';
                
                data.workspaces.forEach(workspace => {
                    const card = document.createElement('div');
                    card.className = 'feature-card';
                    card.innerHTML = `
                        <h3>üè¢ ${workspace.name}</h3>
                        <p>${workspace.description || 'No description'}</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>Active</span>
                        </div>
                        <button class="btn btn-primary" onclick="selectWorkspace('${workspace.id}')" style="margin-top: 10px;">Select</button>
                    `;
                    grid.appendChild(card);
                });
            }
        }

        // Load social media
        async function loadSocialMedia() {
            const response = await fetch(`${API_BASE_URL}/social-media/accounts`, {
                headers: { 'Authorization': `Bearer ${authToken}` }
            });
            const data = await response.json();
            
            if (data.success) {
                const grid = document.getElementById('social-grid');
                grid.innerHTML = '';
                
                data.accounts.forEach(account => {
                    const card = document.createElement('div');
                    card.className = 'feature-card';
                    card.innerHTML = `
                        <h3>üì± ${account.platform}</h3>
                        <p>@${account.username}</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>Connected</span>
                        </div>
                        <button class="btn btn-primary" onclick="manageSocialAccount('${account.id}')" style="margin-top: 10px;">Manage</button>
                    `;
                    grid.appendChild(card);
                });
            }
        }

        // Load bio sites
        async function loadBioSites() {
            const response = await fetch(`${API_BASE_URL}/bio-sites`, {
                headers: { 'Authorization': `Bearer ${authToken}` }
            });
            const data = await response.json();
            
            if (data.success) {
                const grid = document.getElementById('bio-grid');
                grid.innerHTML = '';
                
                data.bio_sites.forEach(site => {
                    const card = document.createElement('div');
                    card.className = 'feature-card';
                    card.innerHTML = `
                        <h3>üîó ${site.title}</h3>
                        <p>${site.description || 'No description'}</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>Active</span>
                        </div>
                        <button class="btn btn-primary" onclick="editBioSite('${site.id}')" style="margin-top: 10px;">Edit</button>
                    `;
                    grid.appendChild(card);
                });
            }
        }

        // Load CRM
        async function loadCRM() {
            const response = await fetch(`${API_BASE_URL}/crm/contacts`, {
                headers: { 'Authorization': `Bearer ${authToken}` }
            });
            const data = await response.json();
            
            if (data.success) {
                const grid = document.getElementById('crm-grid');
                grid.innerHTML = '';
                
                data.contacts.forEach(contact => {
                    const card = document.createElement('div');
                    card.className = 'feature-card';
                    card.innerHTML = `
                        <h3>üë§ ${contact.name}</h3>
                        <p>${contact.email}</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>Active</span>
                        </div>
                        <button class="btn btn-primary" onclick="editContact('${contact.id}')" style="margin-top: 10px;">Edit</button>
                    `;
                    grid.appendChild(card);
                });
            }
        }

        // Load email marketing
        async function loadEmailMarketing() {
            const response = await fetch(`${API_BASE_URL}/email-marketing/campaigns`, {
                headers: { 'Authorization': `Bearer ${authToken}` }
            });
            const data = await response.json();
            
            if (data.success) {
                const grid = document.getElementById('email-grid');
                grid.innerHTML = '';
                
                data.campaigns.forEach(campaign => {
                    const card = document.createElement('div');
                    card.className = 'feature-card';
                    card.innerHTML = `
                        <h3>üìß ${campaign.name}</h3>
                        <p>${campaign.subject}</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>${campaign.status}</span>
                        </div>
                        <button class="btn btn-primary" onclick="editCampaign('${campaign.id}')" style="margin-top: 10px;">Edit</button>
                    `;
                    grid.appendChild(card);
                });
            }
        }

        // Load ecommerce
        async function loadEcommerce() {
            const response = await fetch(`${API_BASE_URL}/ecommerce/products`, {
                headers: { 'Authorization': `Bearer ${authToken}` }
            });
            const data = await response.json();
            
            if (data.success) {
                const grid = document.getElementById('ecommerce-grid');
                grid.innerHTML = '';
                
                data.products.forEach(product => {
                    const card = document.createElement('div');
                    card.className = 'feature-card';
                    card.innerHTML = `
                        <h3>üõí ${product.name}</h3>
                        <p>$${product.price}</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>In Stock</span>
                        </div>
                        <button class="btn btn-primary" onclick="editProduct('${product.id}')" style="margin-top: 10px;">Edit</button>
                    `;
                    grid.appendChild(card);
                });
            }
        }

        // Load courses
        async function loadCourses() {
            const response = await fetch(`${API_BASE_URL}/courses`, {
                headers: { 'Authorization': `Bearer ${authToken}` }
            });
            const data = await response.json();
            
            if (data.success) {
                const grid = document.getElementById('courses-grid');
                grid.innerHTML = '';
                
                data.courses.forEach(course => {
                    const card = document.createElement('div');
                    card.className = 'feature-card';
                    card.innerHTML = `
                        <h3>üìö ${course.title}</h3>
                        <p>${course.description || 'No description'}</p>
                        <div class="feature-status">
                            <span class="status-dot"></span>
                            <span>Published</span>
                        </div>
                        <button class="btn btn-primary" onclick="editCourse('${course.id}')" style="margin-top: 10px;">Edit</button>
                    `;
                    grid.appendChild(card);
                });
            }
        }

        // Load analytics
        async function loadAnalytics() {
            const response = await fetch(`${API_BASE_URL}/analytics`, {
                headers: { 'Authorization': `Bearer ${authToken}` }
            });
            const data = await response.json();
            
            if (data.success) {
                const grid = document.getElementById('analytics-grid');
                grid.innerHTML = '';
                
                const analyticsCard = document.createElement('div');
                analyticsCard.className = 'feature-card';
                analyticsCard.innerHTML = `
                    <h3>üìä Analytics Overview</h3>
                    <p>Total Views: ${data.analytics.total_views || 0}</p>
                    <p>Total Clicks: ${data.analytics.total_clicks || 0}</p>
                    <p>Conversion Rate: ${data.analytics.conversion_rate || 0}%</p>
                    <div class="feature-status">
                        <span class="status-dot"></span>
                        <span>Updated</span>
                    </div>
                `;
                grid.appendChild(analyticsCard);
            }
        }

        // Action functions
        function refreshData() {
            loadDashboardData();
        }

        function createWorkspace() {
            const name = prompt('Enter workspace name:');
            if (name) {
                fetch(`${API_BASE_URL}/workspaces`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ name: name })
                }).then(() => {
                    loadWorkspaces();
                    loadDashboardData();
                });
            }
        }

        function connectSocialAccount() {
            alert('Social account connection feature will be implemented.');
        }

        function createBioSite() {
            const title = prompt('Enter bio site title:');
            if (title) {
                fetch(`${API_BASE_URL}/bio-sites`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ title: title })
                }).then(() => {
                    loadBioSites();
                    loadDashboardData();
                });
            }
        }

        function createLead() {
            const name = prompt('Enter lead name:');
            const email = prompt('Enter lead email:');
            if (name && email) {
                fetch(`${API_BASE_URL}/crm/leads`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ name: name, email: email })
                }).then(() => {
                    loadCRM();
                    loadDashboardData();
                });
            }
        }

        function createCampaign() {
            const name = prompt('Enter campaign name:');
            if (name) {
                fetch(`${API_BASE_URL}/email-marketing/campaigns`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ name: name })
                }).then(() => {
                    loadEmailMarketing();
                });
            }
        }

        function createProduct() {
            const name = prompt('Enter product name:');
            const price = prompt('Enter product price:');
            if (name && price) {
                fetch(`${API_BASE_URL}/ecommerce/products`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ name: name, price: parseFloat(price) })
                }).then(() => {
                    loadEcommerce();
                });
            }
        }

        function createCourse() {
            const title = prompt('Enter course title:');
            if (title) {
                fetch(`${API_BASE_URL}/courses`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ title: title })
                }).then(() => {
                    loadCourses();
                });
            }
        }

        function generateReport() {
            alert('Report generation feature will be implemented.');
        }

        function setup2FA() {
            alert('2FA setup feature will be implemented.');
        }

        function manageOAuth() {
            alert('OAuth management feature will be implemented.');
        }

        function updateProfile() {
            alert('Profile update feature will be implemented.');
        }

        function logout() {
            localStorage.removeItem('auth_token');
            localStorage.removeItem('user_data');
            window.location.href = '/login';
        }

        // Utility functions
        function showMessage(message, type) {
            const messageElement = document.getElementById(`${type}-message`);
            messageElement.textContent = message;
            messageElement.style.display = 'block';
            
            setTimeout(() => {
                messageElement.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>