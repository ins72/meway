<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workspace Setup Wizard - Mewayz</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007cba, #0096dd);
            transition: width 0.3s ease;
        }
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            font-size: 14px;
        }
        .step {
            flex: 1;
            text-align: center;
            position: relative;
        }
        .step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #e0e0e0;
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
        }
        .step.active .step-number {
            background-color: #007cba;
            color: white;
        }
        .step.completed .step-number {
            background-color: #28a745;
            color: white;
        }
        .step-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        .step-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #007cba;
        }
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        .form-row {
            display: flex;
            gap: 20px;
        }
        .form-row .form-group {
            flex: 1;
        }
        .color-picker {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .color-picker input[type="color"] {
            width: 60px;
            height: 40px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        .platform-list {
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 20px;
            background-color: #f9f9f9;
        }
        .platform-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            margin-bottom: 10px;
            background-color: white;
        }
        .platform-item input[type="checkbox"] {
            width: auto;
        }
        .platform-item .platform-details {
            flex: 1;
            display: flex;
            gap: 15px;
        }
        .platform-item .platform-details input {
            margin-bottom: 0;
        }
        .tag-input {
            position: relative;
        }
        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        .tag {
            background-color: #007cba;
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .tag .remove-tag {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 14px;
        }
        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .btn-primary {
            background-color: #007cba;
            color: white;
        }
        .btn-primary:hover {
            background-color: #005a8b;
        }
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #545b62;
        }
        .btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .status {
            padding: 15px;
            margin-top: 20px;
            border-radius: 6px;
            font-weight: bold;
            text-align: center;
        }
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .summary-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            background-color: #f9f9f9;
        }
        .summary-section h3 {
            margin-top: 0;
            color: #007cba;
        }
        .summary-item {
            margin-bottom: 10px;
        }
        .summary-item strong {
            color: #333;
        }
        .completion-message {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #007cba, #0096dd);
            color: white;
            border-radius: 10px;
            margin-top: 20px;
        }
        .completion-message h2 {
            margin-bottom: 20px;
            font-size: 2.5em;
        }
        .completion-message p {
            font-size: 1.2em;
            margin-bottom: 30px;
        }
        .auth-section {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f0f8ff;
            border-radius: 6px;
            border: 1px solid #b3d9ff;
        }
        .auth-section input {
            margin: 10px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .auth-section button {
            margin: 10px;
            padding: 10px 20px;
            background-color: #007cba;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸš€ Workspace Setup Wizard - Mewayz</h1>
        
        <!-- Authentication Section -->
        <div class="auth-section" id="authSection">
            <h3>Please Login to Continue</h3>
            <p>You need to be logged in to access the workspace setup wizard.</p>
            <input type="email" id="loginEmail" placeholder="admin@example.com" value="admin@example.com">
            <input type="password" id="loginPassword" placeholder="Password" value="admin123">
            <button onclick="login()">Login</button>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-bar" id="progressBar" style="display: none;">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <!-- Step Indicator -->
        <div class="step-indicator" id="stepIndicator" style="display: none;">
            <div class="step" id="step1">
                <div class="step-number">1</div>
                <div>Business Info</div>
            </div>
            <div class="step" id="step2">
                <div class="step-number">2</div>
                <div>Social Media</div>
            </div>
            <div class="step" id="step3">
                <div class="step-number">3</div>
                <div>Branding</div>
            </div>
            <div class="step" id="step4">
                <div class="step-number">4</div>
                <div>Content</div>
            </div>
            <div class="step" id="step5">
                <div class="step-number">5</div>
                <div>Goals</div>
            </div>
            <div class="step" id="step6">
                <div class="step-number">6</div>
                <div>Complete</div>
            </div>
        </div>
        
        <!-- Step 1: Business Information -->
        <div class="step-content" id="step1-content">
            <h2>Step 1: Business Information</h2>
            <form id="businessForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="businessName">Business Name *</label>
                        <input type="text" id="businessName" required>
                    </div>
                    <div class="form-group">
                        <label for="businessType">Business Type *</label>
                        <select id="businessType" required>
                            <option value="">Select business type</option>
                            <option value="sole_proprietorship">Sole Proprietorship</option>
                            <option value="partnership">Partnership</option>
                            <option value="llc">LLC</option>
                            <option value="corporation">Corporation</option>
                            <option value="nonprofit">Nonprofit</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="industry">Industry *</label>
                        <select id="industry" required>
                            <option value="">Select industry</option>
                            <option value="technology">Technology</option>
                            <option value="healthcare">Healthcare</option>
                            <option value="finance">Finance</option>
                            <option value="education">Education</option>
                            <option value="retail">Retail</option>
                            <option value="manufacturing">Manufacturing</option>
                            <option value="services">Services</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="businessSize">Business Size *</label>
                        <select id="businessSize" required>
                            <option value="">Select size</option>
                            <option value="1-10">1-10 employees</option>
                            <option value="11-50">11-50 employees</option>
                            <option value="51-200">51-200 employees</option>
                            <option value="201-1000">201-1000 employees</option>
                            <option value="1000+">1000+ employees</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="website">Website</label>
                        <input type="url" id="website" placeholder="https://example.com">
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone</label>
                        <input type="tel" id="phone" placeholder="+1 (555) 123-4567">
                    </div>
                </div>
                <div class="form-group">
                    <label for="address">Address</label>
                    <textarea id="address" placeholder="Enter your business address"></textarea>
                </div>
                <div class="form-group">
                    <label for="description">Business Description</label>
                    <textarea id="description" placeholder="Describe your business in a few sentences"></textarea>
                </div>
            </form>
        </div>
        
        <!-- Step 2: Social Media -->
        <div class="step-content" id="step2-content">
            <h2>Step 2: Social Media Setup</h2>
            <form id="socialMediaForm">
                <div class="form-group">
                    <label>Social Media Platforms *</label>
                    <div class="platform-list">
                        <div class="platform-item">
                            <input type="checkbox" id="instagram" value="instagram">
                            <label for="instagram">Instagram</label>
                            <div class="platform-details">
                                <input type="text" placeholder="Username" id="instagram-username">
                                <input type="url" placeholder="Profile URL" id="instagram-url">
                                <label><input type="checkbox" id="instagram-primary"> Primary</label>
                            </div>
                        </div>
                        <div class="platform-item">
                            <input type="checkbox" id="facebook" value="facebook">
                            <label for="facebook">Facebook</label>
                            <div class="platform-details">
                                <input type="text" placeholder="Username" id="facebook-username">
                                <input type="url" placeholder="Profile URL" id="facebook-url">
                                <label><input type="checkbox" id="facebook-primary"> Primary</label>
                            </div>
                        </div>
                        <div class="platform-item">
                            <input type="checkbox" id="twitter" value="twitter">
                            <label for="twitter">Twitter</label>
                            <div class="platform-details">
                                <input type="text" placeholder="Username" id="twitter-username">
                                <input type="url" placeholder="Profile URL" id="twitter-url">
                                <label><input type="checkbox" id="twitter-primary"> Primary</label>
                            </div>
                        </div>
                        <div class="platform-item">
                            <input type="checkbox" id="linkedin" value="linkedin">
                            <label for="linkedin">LinkedIn</label>
                            <div class="platform-details">
                                <input type="text" placeholder="Username" id="linkedin-username">
                                <input type="url" placeholder="Profile URL" id="linkedin-url">
                                <label><input type="checkbox" id="linkedin-primary"> Primary</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="contentTypes">Content Types</label>
                    <div class="tag-input">
                        <input type="text" id="contentTypesInput" placeholder="Enter content type and press Enter">
                        <div class="tags-container" id="contentTypesTags"></div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="postingFrequency">Posting Frequency *</label>
                        <select id="postingFrequency" required>
                            <option value="">Select frequency</option>
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="bi-weekly">Bi-weekly</option>
                            <option value="monthly">Monthly</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="targetAudience">Target Audience *</label>
                    <textarea id="targetAudience" placeholder="Describe your target audience" required></textarea>
                </div>
            </form>
        </div>
        
        <!-- Step 3: Branding -->
        <div class="step-content" id="step3-content">
            <h2>Step 3: Brand Colors & Voice</h2>
            <form id="brandingForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="primaryColor">Primary Color *</label>
                        <div class="color-picker">
                            <input type="color" id="primaryColor" value="#007cba" required>
                            <input type="text" id="primaryColorText" value="#007cba" readonly>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="secondaryColor">Secondary Color *</label>
                        <div class="color-picker">
                            <input type="color" id="secondaryColor" value="#0096dd" required>
                            <input type="text" id="secondaryColorText" value="#0096dd" readonly>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="accentColor">Accent Color</label>
                    <div class="color-picker">
                        <input type="color" id="accentColor" value="#28a745">
                        <input type="text" id="accentColorText" value="#28a745" readonly>
                    </div>
                </div>
                <div class="form-group">
                    <label for="brandVoice">Brand Voice *</label>
                    <select id="brandVoice" required>
                        <option value="">Select brand voice</option>
                        <option value="professional">Professional</option>
                        <option value="casual">Casual</option>
                        <option value="friendly">Friendly</option>
                        <option value="authoritative">Authoritative</option>
                        <option value="playful">Playful</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="brandValues">Brand Values</label>
                    <div class="tag-input">
                        <input type="text" id="brandValuesInput" placeholder="Enter brand value and press Enter">
                        <div class="tags-container" id="brandValuesTags"></div>
                    </div>
                </div>
            </form>
        </div>
        
        <!-- Step 4: Content Categories -->
        <div class="step-content" id="step4-content">
            <h2>Step 4: Content Categories</h2>
            <form id="contentForm">
                <div class="form-group">
                    <label for="categories">Content Categories *</label>
                    <div class="tag-input">
                        <input type="text" id="categoriesInput" placeholder="Enter category and press Enter">
                        <div class="tags-container" id="categoriesTags"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="contentPillars">Content Pillars (3-5 required) *</label>
                    <div class="tag-input">
                        <input type="text" id="contentPillarsInput" placeholder="Enter content pillar and press Enter">
                        <div class="tags-container" id="contentPillarsTags"></div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="contentStyle">Content Style *</label>
                        <select id="contentStyle" required>
                            <option value="">Select style</option>
                            <option value="educational">Educational</option>
                            <option value="entertaining">Entertaining</option>
                            <option value="promotional">Promotional</option>
                            <option value="inspirational">Inspirational</option>
                            <option value="mixed">Mixed</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="hashtagStrategy">Hashtag Strategy *</label>
                        <select id="hashtagStrategy" required>
                            <option value="">Select strategy</option>
                            <option value="trending">Trending</option>
                            <option value="branded">Branded</option>
                            <option value="mixed">Mixed</option>
                            <option value="niche">Niche</option>
                        </select>
                    </div>
                </div>
            </form>
        </div>
        
        <!-- Step 5: Goals & Objectives -->
        <div class="step-content" id="step5-content">
            <h2>Step 5: Goals & Objectives</h2>
            <form id="goalsForm">
                <div class="form-group">
                    <label for="primaryGoal">Primary Goal *</label>
                    <select id="primaryGoal" required>
                        <option value="">Select primary goal</option>
                        <option value="brand_awareness">Brand Awareness</option>
                        <option value="lead_generation">Lead Generation</option>
                        <option value="sales">Sales</option>
                        <option value="engagement">Engagement</option>
                        <option value="traffic">Website Traffic</option>
                        <option value="community_building">Community Building</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Target Metrics *</label>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="targetFollowers">Followers</label>
                            <input type="number" id="targetFollowers" min="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="targetEngagement">Engagement Rate (%)</label>
                            <input type="number" id="targetEngagement" min="0" max="100" step="0.1" placeholder="0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="targetReach">Monthly Reach</label>
                            <input type="number" id="targetReach" min="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="targetConversions">Conversions</label>
                            <input type="number" id="targetConversions" min="0" placeholder="0">
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="timeline">Timeline *</label>
                        <select id="timeline" required>
                            <option value="">Select timeline</option>
                            <option value="1_month">1 Month</option>
                            <option value="3_months">3 Months</option>
                            <option value="6_months">6 Months</option>
                            <option value="1_year">1 Year</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="budget">Budget *</label>
                        <select id="budget" required>
                            <option value="">Select budget</option>
                            <option value="0-100">$0 - $100</option>
                            <option value="100-500">$100 - $500</option>
                            <option value="500-1000">$500 - $1,000</option>
                            <option value="1000-5000">$1,000 - $5,000</option>
                            <option value="5000+">$5,000+</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="successMetrics">Success Metrics</label>
                    <div class="tag-input">
                        <input type="text" id="successMetricsInput" placeholder="Enter success metric and press Enter">
                        <div class="tags-container" id="successMetricsTags"></div>
                    </div>
                </div>
            </form>
        </div>
        
        <!-- Step 6: Review & Complete -->
        <div class="step-content" id="step6-content">
            <h2>Step 6: Review & Complete</h2>
            <div id="setupSummary">
                <!-- Summary will be populated here -->
            </div>
            <div class="completion-message" id="completionMessage" style="display: none;">
                <h2>ðŸŽ‰ Congratulations!</h2>
                <p>Your workspace setup is now complete!</p>
                <p>You're all set to start building your amazing business presence with Mewayz.</p>
            </div>
        </div>
        
        <!-- Navigation Buttons -->
        <div class="buttons" id="navigationButtons" style="display: none;">
            <button class="btn btn-secondary" id="prevBtn" onclick="previousStep()">Previous</button>
            <button class="btn btn-primary" id="nextBtn" onclick="nextStep()">Next</button>
        </div>
        
        <!-- Status Messages -->
        <div id="status"></div>
    </div>

    <script>
        let currentStep = 1;
        let authToken = null;
        let setupData = {};
        let contentTypes = [];
        let brandValues = [];
        let categories = [];
        let contentPillars = [];
        let successMetrics = [];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeTagInputs();
            initializeColorPickers();
        });
        
        function initializeTagInputs() {
            // Content Types
            const contentTypesInput = document.getElementById('contentTypesInput');
            if (contentTypesInput) {
                contentTypesInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        addTag(this.value, 'contentTypes', contentTypes);
                        this.value = '';
                    }
                });
            }
            
            // Brand Values
            const brandValuesInput = document.getElementById('brandValuesInput');
            if (brandValuesInput) {
                brandValuesInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        addTag(this.value, 'brandValues', brandValues);
                        this.value = '';
                    }
                });
            }
            
            // Categories
            const categoriesInput = document.getElementById('categoriesInput');
            if (categoriesInput) {
                categoriesInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        addTag(this.value, 'categories', categories);
                        this.value = '';
                    }
                });
            }
            
            // Content Pillars
            const contentPillarsInput = document.getElementById('contentPillarsInput');
            if (contentPillarsInput) {
                contentPillarsInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        addTag(this.value, 'contentPillars', contentPillars);
                        this.value = '';
                    }
                });
            }
            
            // Success Metrics
            const successMetricsInput = document.getElementById('successMetricsInput');
            if (successMetricsInput) {
                successMetricsInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        addTag(this.value, 'successMetrics', successMetrics);
                        this.value = '';
                    }
                });
            }
        }
        
        function initializeColorPickers() {
            const colorInputs = ['primaryColor', 'secondaryColor', 'accentColor'];
            colorInputs.forEach(colorId => {
                const colorInput = document.getElementById(colorId);
                const textInput = document.getElementById(colorId + 'Text');
                
                if (colorInput && textInput) {
                    colorInput.addEventListener('input', function() {
                        textInput.value = this.value;
                    });
                }
            });
        }
        
        function addTag(value, containerId, array) {
            if (value.trim() && !array.includes(value.trim())) {
                array.push(value.trim());
                renderTags(containerId, array);
            }
        }
        
        function removeTag(value, containerId, array) {
            const index = array.indexOf(value);
            if (index > -1) {
                array.splice(index, 1);
                renderTags(containerId, array);
            }
        }
        
        function renderTags(containerId, array) {
            const container = document.getElementById(containerId + 'Tags');
            container.innerHTML = '';
            
            array.forEach(tag => {
                const tagElement = document.createElement('div');
                tagElement.className = 'tag';
                tagElement.innerHTML = `
                    ${tag}
                    <button type="button" class="remove-tag" onclick="removeTag('${tag}', '${containerId}', ${containerId})">Ã—</button>
                `;
                container.appendChild(tagElement);
            });
        }
        
        async function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    authToken = data.token;
                    document.getElementById('authSection').style.display = 'none';
                    document.getElementById('progressBar').style.display = 'block';
                    document.getElementById('stepIndicator').style.display = 'flex';
                    document.getElementById('navigationButtons').style.display = 'flex';
                    
                    // Load current setup step
                    await loadCurrentStep();
                } else {
                    showStatus('Login failed: ' + data.message, 'error');
                }
            } catch (error) {
                showStatus('Login failed: ' + error.message, 'error');
            }
        }
        
        async function loadCurrentStep() {
            try {
                const response = await fetch('/api/workspace-setup/current-step', {
                    headers: {
                        'Authorization': 'Bearer ' + authToken,
                        'Content-Type': 'application/json',
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    currentStep = data.current_step;
                    updateUI();
                    
                    if (data.setup_completed) {
                        showCompletionMessage();
                    }
                } else {
                    showStatus('Error loading setup: ' + data.error, 'error');
                }
            } catch (error) {
                showStatus('Error loading setup: ' + error.message, 'error');
            }
        }
        
        function updateUI() {
            // Update progress bar
            const progressPercent = ((currentStep - 1) / 5) * 100;
            document.getElementById('progressFill').style.width = progressPercent + '%';
            
            // Update step indicator
            document.querySelectorAll('.step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 === currentStep) {
                    step.classList.add('active');
                } else if (index + 1 < currentStep) {
                    step.classList.add('completed');
                }
            });
            
            // Show current step content
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById('step' + currentStep + '-content').classList.add('active');
            
            // Update navigation buttons
            document.getElementById('prevBtn').style.display = currentStep > 1 ? 'inline-block' : 'none';
            document.getElementById('nextBtn').textContent = currentStep === 6 ? 'Complete Setup' : 'Next';
        }
        
        async function nextStep() {
            if (currentStep === 6) {
                await completeSetup();
            } else {
                if (await saveCurrentStep()) {
                    currentStep++;
                    updateUI();
                    
                    if (currentStep === 6) {
                        await loadSetupSummary();
                    }
                }
            }
        }
        
        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                updateUI();
            }
        }
        
        async function saveCurrentStep() {
            let endpoint = '';
            let data = {};
            
            switch (currentStep) {
                case 1:
                    endpoint = '/api/workspace-setup/business-info';
                    data = {
                        business_name: document.getElementById('businessName').value,
                        business_type: document.getElementById('businessType').value,
                        industry: document.getElementById('industry').value,
                        business_size: document.getElementById('businessSize').value,
                        website: document.getElementById('website').value,
                        phone: document.getElementById('phone').value,
                        address: document.getElementById('address').value,
                        description: document.getElementById('description').value
                    };
                    break;
                    
                case 2:
                    endpoint = '/api/workspace-setup/social-media';
                    const platforms = [];
                    ['instagram', 'facebook', 'twitter', 'linkedin'].forEach(platform => {
                        const checkbox = document.getElementById(platform);
                        if (checkbox.checked) {
                            platforms.push({
                                platform: platform,
                                username: document.getElementById(platform + '-username').value,
                                url: document.getElementById(platform + '-url').value,
                                primary: document.getElementById(platform + '-primary').checked
                            });
                        }
                    });
                    
                    data = {
                        platforms: platforms,
                        content_types: contentTypes,
                        posting_frequency: document.getElementById('postingFrequency').value,
                        target_audience: document.getElementById('targetAudience').value
                    };
                    break;
                    
                case 3:
                    endpoint = '/api/workspace-setup/branding';
                    data = {
                        primary_color: document.getElementById('primaryColor').value,
                        secondary_color: document.getElementById('secondaryColor').value,
                        accent_color: document.getElementById('accentColor').value,
                        brand_voice: document.getElementById('brandVoice').value,
                        brand_values: brandValues
                    };
                    break;
                    
                case 4:
                    endpoint = '/api/workspace-setup/content-categories';
                    data = {
                        categories: categories,
                        content_pillars: contentPillars,
                        content_style: document.getElementById('contentStyle').value,
                        hashtag_strategy: document.getElementById('hashtagStrategy').value
                    };
                    break;
                    
                case 5:
                    endpoint = '/api/workspace-setup/goals-objectives';
                    data = {
                        primary_goal: document.getElementById('primaryGoal').value,
                        target_metrics: {
                            followers: parseInt(document.getElementById('targetFollowers').value) || 0,
                            engagement_rate: parseFloat(document.getElementById('targetEngagement').value) || 0,
                            monthly_reach: parseInt(document.getElementById('targetReach').value) || 0,
                            conversions: parseInt(document.getElementById('targetConversions').value) || 0
                        },
                        timeline: document.getElementById('timeline').value,
                        budget: document.getElementById('budget').value,
                        success_metrics: successMetrics
                    };
                    break;
                    
                default:
                    return true;
            }
            
            try {
                const response = await fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + authToken,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showStatus(result.message, 'success');
                    return true;
                } else {
                    showStatus('Error saving step: ' + result.error, 'error');
                    return false;
                }
            } catch (error) {
                showStatus('Error saving step: ' + error.message, 'error');
                return false;
            }
        }
        
        async function loadSetupSummary() {
            try {
                const response = await fetch('/api/workspace-setup/summary', {
                    headers: {
                        'Authorization': 'Bearer ' + authToken,
                        'Content-Type': 'application/json',
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    renderSetupSummary(data.summary);
                } else {
                    showStatus('Error loading summary: ' + data.error, 'error');
                }
            } catch (error) {
                showStatus('Error loading summary: ' + error.message, 'error');
            }
        }
        
        function renderSetupSummary(summary) {
            const container = document.getElementById('setupSummary');
            container.innerHTML = '';
            
            // Business Info
            if (summary.business_info) {
                const section = document.createElement('div');
                section.className = 'summary-section';
                section.innerHTML = `
                    <h3>Business Information</h3>
                    <div class="summary-item"><strong>Name:</strong> ${summary.business_info.business_name || 'N/A'}</div>
                    <div class="summary-item"><strong>Type:</strong> ${summary.business_info.business_type || 'N/A'}</div>
                    <div class="summary-item"><strong>Industry:</strong> ${summary.business_info.industry || 'N/A'}</div>
                    <div class="summary-item"><strong>Size:</strong> ${summary.business_info.business_size || 'N/A'}</div>
                    <div class="summary-item"><strong>Website:</strong> ${summary.business_info.website || 'N/A'}</div>
                `;
                container.appendChild(section);
            }
            
            // Social Media
            if (summary.social_media) {
                const section = document.createElement('div');
                section.className = 'summary-section';
                let platformsHtml = '';
                if (summary.social_media.platforms) {
                    summary.social_media.platforms.forEach(platform => {
                        platformsHtml += `<div class="summary-item"><strong>${platform.platform}:</strong> ${platform.username} (${platform.url})</div>`;
                    });
                }
                section.innerHTML = `
                    <h3>Social Media</h3>
                    ${platformsHtml}
                    <div class="summary-item"><strong>Posting Frequency:</strong> ${summary.social_media.posting_frequency || 'N/A'}</div>
                `;
                container.appendChild(section);
            }
            
            // Branding
            if (summary.branding) {
                const section = document.createElement('div');
                section.className = 'summary-section';
                section.innerHTML = `
                    <h3>Branding</h3>
                    <div class="summary-item"><strong>Primary Color:</strong> <span style="color: ${summary.branding.primary_color}">${summary.branding.primary_color}</span></div>
                    <div class="summary-item"><strong>Secondary Color:</strong> <span style="color: ${summary.branding.secondary_color}">${summary.branding.secondary_color}</span></div>
                    <div class="summary-item"><strong>Brand Voice:</strong> ${summary.branding.brand_voice || 'N/A'}</div>
                `;
                container.appendChild(section);
            }
            
            // Content Categories
            if (summary.content_categories) {
                const section = document.createElement('div');
                section.className = 'summary-section';
                section.innerHTML = `
                    <h3>Content Strategy</h3>
                    <div class="summary-item"><strong>Categories:</strong> ${summary.content_categories.categories ? summary.content_categories.categories.join(', ') : 'N/A'}</div>
                    <div class="summary-item"><strong>Content Pillars:</strong> ${summary.content_categories.content_pillars ? summary.content_categories.content_pillars.join(', ') : 'N/A'}</div>
                    <div class="summary-item"><strong>Content Style:</strong> ${summary.content_categories.content_style || 'N/A'}</div>
                `;
                container.appendChild(section);
            }
            
            // Goals & Objectives
            if (summary.goals_objectives) {
                const section = document.createElement('div');
                section.className = 'summary-section';
                section.innerHTML = `
                    <h3>Goals & Objectives</h3>
                    <div class="summary-item"><strong>Primary Goal:</strong> ${summary.goals_objectives.primary_goal || 'N/A'}</div>
                    <div class="summary-item"><strong>Timeline:</strong> ${summary.goals_objectives.timeline || 'N/A'}</div>
                    <div class="summary-item"><strong>Budget:</strong> ${summary.goals_objectives.budget || 'N/A'}</div>
                `;
                container.appendChild(section);
            }
        }
        
        async function completeSetup() {
            try {
                const response = await fetch('/api/workspace-setup/complete', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + authToken,
                        'Content-Type': 'application/json',
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showCompletionMessage();
                    showStatus(data.message, 'success');
                } else {
                    showStatus('Error completing setup: ' + data.error, 'error');
                }
            } catch (error) {
                showStatus('Error completing setup: ' + error.message, 'error');
            }
        }
        
        function showCompletionMessage() {
            document.getElementById('completionMessage').style.display = 'block';
            document.getElementById('navigationButtons').style.display = 'none';
        }
        
        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }
        
        // Initialize UI
        updateUI();
    </script>
</body>
</html>